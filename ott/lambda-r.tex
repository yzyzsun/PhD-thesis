% generated by Ott 0.34 from: ott/lambda-r.ott
\newcommand{\ottdrule}[4][]{{\displaystyle\frac{\begin{array}{l}#2\end{array}}{#3}\quad\ottdrulename{#4}}}
\newcommand{\ottusedrule}[1]{\[#1\]}
\newcommand{\ottpremise}[1]{ #1 \\}
\newenvironment{ottdefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]}{}
\newenvironment{ottfundefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]\begin{displaymath}\begin{array}{l}}{\end{array}\end{displaymath}}
\newcommand{\ottfunclause}[2]{ #1 \equiv #2 \\}
\newcommand{\ottnt}[1]{\mathit{#1}}
\newcommand{\ottmv}[1]{\mathit{#1}}
\newcommand{\ottkw}[1]{\mathbf{#1}}
\newcommand{\ottsym}[1]{#1}
\newcommand{\ottcom}[1]{\text{#1}}
\newcommand{\ottdrulename}[1]{\textsc{#1}}
\newcommand{\ottcomplu}[5]{\overline{#1}^{\,#2\in #3 #4 #5}}
\newcommand{\ottcompu}[3]{\overline{#1}^{\,#2<#3}}
\newcommand{\ottcomp}[2]{\overline{#1}^{\,#2}}
\newcommand{\ottgrammartabular}[1]{\begin{supertabular}{llcllllll}#1\end{supertabular}}
\newcommand{\ottmetavartabular}[1]{\begin{supertabular}{ll}#1\end{supertabular}}
\newcommand{\ottrulehead}[3]{$#1$ & & $#2$ & & & \multicolumn{2}{l}{#3}}
\newcommand{\ottprodline}[6]{& & $#1$ & $#2$ & $#3 #4$ & $#5$ & $#6$}
\newcommand{\ottfirstprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottlongprodline}[2]{& & $#1$ & \multicolumn{4}{l}{$#2$}}
\newcommand{\ottfirstlongprodline}[2]{\ottlongprodline{#1}{#2}}
\newcommand{\ottbindspecprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottprodnewline}{\\}
\newcommand{\ottinterrule}{\\[5.0mm]}
\newcommand{\ottafterlastrule}{\\}
\newcommand{\ottmetavars}{
\ottmetavartabular{
 $ \ottmv{var} ,\, \ottmv{x} ,\, \ottmv{y} ,\, f \! $ &  \\
 $ \ottmv{label} ,\, \ell $ &  \\
 $ \ottmv{index} ,\, \ottmv{i} ,\, \ottmv{j} ,\, \ottmv{k} ,\, \ottmv{n} ,\, \ottmv{m} $ & \ottcom{indices} \\
}}

\newcommand{\otttyp}{
\ottrulehead{\ottnt{typ}  ,\ \ottnt{A}  ,\ \ottnt{B}  ,\ \ottnt{C}  ,\ A^\circ  ,\ B^\circ  ,\ C^\circ}{::=}{\ottcom{types}}\ottprodnewline
\ottfirstprodline{|}{ \top }{}{}{}{\ottcom{top type}}\ottprodnewline
\ottprodline{|}{ \bot }{}{}{}{\ottcom{bottom type}}\ottprodnewline
\ottprodline{|}{ \mathbb{Z} }{}{}{}{\ottcom{base type}}\ottprodnewline
\ottprodline{|}{\ottnt{A}  \rightarrow  \ottnt{B}}{}{}{}{\ottcom{function type}}\ottprodnewline
\ottprodline{|}{\ottnt{A}  \, {\&} \,  \ottnt{B}}{}{}{}{\ottcom{intersection}}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}}}{}{}{}{\ottcom{record}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{A}  \ottsym{)}} {\textsf{S}}{}{}{}}

\newcommand{\ottexp}{
\ottrulehead{\ottnt{exp}  ,\ \ottnt{e}}{::=}{\ottcom{expressions}}\ottprodnewline
\ottfirstprodline{|}{ \top }{}{}{}{\ottcom{top value}}\ottprodnewline
\ottprodline{|}{\ottmv{n}}{}{}{}{\ottcom{integer literal}}\ottprodnewline
\ottprodline{|}{\ottmv{x}}{}{}{}{\ottcom{variables}}\ottprodnewline
\ottprodline{|}{ \lambda \ottmv{x} .\, \ottnt{e} : \ottnt{A} \rightarrow \ottnt{B} }{}{\textsf{bind}\; \ottmv{x}\; \textsf{in}\; \ottnt{e}}{}{\ottcom{abstractions}}\ottprodnewline
\ottprodline{|}{ \ottkw{fix} ~ \ottmv{x} .\, \ottnt{e} : \ottnt{A} }{}{\textsf{bind}\; \ottmv{x}\; \textsf{in}\; \ottnt{e}}{}{\ottcom{fixpoint}}\ottprodnewline
\ottprodline{|}{\ottnt{e_{{\mathrm{1}}}} \, \ottnt{e_{{\mathrm{2}}}}}{}{}{}{\ottcom{applications}}\ottprodnewline
\ottprodline{|}{\ottnt{e_{{\mathrm{1}}}}  \bbcomma  \ottnt{e_{{\mathrm{2}}}}}{}{}{}{\ottcom{merge}}\ottprodnewline
\ottprodline{|}{\ottnt{e}  :  \ottnt{A}}{}{}{}{\ottcom{annotation}}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ell  \ottsym{=}  \ottnt{e}  \ottsym{\}}}{}{}{}{\ottcom{record}}\ottprodnewline
\ottprodline{|}{\ottnt{e}  \ottsym{.}  \ell}{}{}{}{\ottcom{projection}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{e}  \ottsym{)}} {\textsf{S}}{}{}{}\ottprodnewline
\ottprodline{|}{ \lambda \ottmv{x} .\, \ottnt{e} }{}{\textsf{bind}\; \ottmv{x}\; \textsf{in}\; \ottnt{e}}{}{}\ottprodnewline
\ottprodline{|}{ \ottnt{e}  . \mathsf{fst} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \ottnt{e}  . \mathsf{snd} }{}{}{}{}}

\newcommand{\ottctx}{
\ottrulehead{\ottnt{ctx}  ,\ \Gamma}{::=}{\ottcom{typing context}}\ottprodnewline
\ottfirstprodline{|}{ \cdot }{}{}{}{\ottcom{empty context}}\ottprodnewline
\ottprodline{|}{\Gamma  \ottsym{,}  \ottmv{x}  :  \ottnt{A}}{}{}{}{\ottcom{assumption}}}

\newcommand{\ottdirflag}{
\ottrulehead{\Leftrightarrow}{::=}{\ottcom{checking direction}}\ottprodnewline
\ottfirstprodline{|}{\Rightarrow}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Leftarrow}{}{}{}{}}

\newcommand{\ottrcdtyp}{
\ottrulehead{\ottnt{rcdtyp}  ,\ \rho}{::=}{\ottcom{record type}}\ottprodnewline
\ottfirstprodline{|}{\ottsym{\{}  \ell_{{\mathrm{1}}}  \Mapsto  \mathcal{A}_{{\mathrm{1}}}  ; \, \, .. \, ; \,  \ell_{\ottmv{n}}  \Mapsto  \mathcal{A}_{\ottmv{n}}  \ottsym{\}}}{}{}{}{}}

\newcommand{\ottttyp}{
\ottrulehead{\textit{target types}  ,\ \mathcal{A}  ,\ \mathcal{B}  ,\ \mathcal{C}}{::=}{\ottcom{types}}\ottprodnewline
\ottfirstprodline{|}{ \bot }{}{}{}{\ottcom{bottom type}}\ottprodnewline
\ottprodline{|}{ \mathbb{Z} }{}{}{}{\ottcom{base type}}\ottprodnewline
\ottprodline{|}{\mathcal{A}  \rightarrow  \mathcal{B}}{}{}{}{\ottcom{function types}}\ottprodnewline
\ottprodline{|}{\rho}{}{}{}{\ottcom{record types}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \mathcal{A}  \ottsym{)}} {\textsf{S}}{}{}{}}

\newcommand{\otttindx}{
\ottrulehead{\ottnt{tindx}  ,\ \ottnt{T}  ,\ \ottnt{Ts}  ,\ \ottnt{K}  ,\ \ottnt{U}  ,\ \ell}{::=}{\ottcom{Type indices}}\ottprodnewline
\ottfirstprodline{|}{ \overline{\mathbb{Z} } }{}{}{}{\ottcom{base type}}\ottprodnewline
\ottprodline{|}{ \bot }{}{}{}{\ottcom{bottom type}}\ottprodnewline
\ottprodline{|}{ \overline{ \ottnt{T_{{\mathrm{1}}}} \rightarrow \ottnt{T_{{\mathrm{2}}}} } }{}{}{}{\ottcom{function type}}\ottprodnewline
\ottprodline{|}{ \overline{  \ottsym{\{}   \ell   :   \ottnt{T}   \ottsym{\}}  } }{}{}{}{\ottcom{record type}}\ottprodnewline
\ottprodline{|}{\ottsym{[}  \ottnt{T_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{T_{\ottmv{n}}}  \ottsym{]}}{}{}{}{\ottcom{intersection type}}\ottprodnewline
\ottprodline{|}{\textbf{merge} \, \ottnt{T_{{\mathrm{1}}}} \, \ottnt{T_{{\mathrm{2}}}}}{}{}{}{\ottcom{append two lists and sort it}}\ottprodnewline
\ottprodline{|}{\textbf{dedup} \, \ottnt{T}}{}{}{}{\ottcom{remove duplicates}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{T}  \ottsym{)}} {\textsf{S}}{}{}{}\ottprodnewline
\ottprodline{|}{\ell}{}{}{}{}}

\newcommand{\otttexp}{
\ottrulehead{\textit{target expressions}  ,\ \epsilon  ,\ \nu}{::=}{\ottcom{target term}}\ottprodnewline
\ottfirstprodline{|}{\ottmv{x}}{}{}{}{\ottcom{variable}}\ottprodnewline
\ottprodline{|}{\ottmv{n}}{}{}{}{\ottcom{integer value}}\ottprodnewline
\ottprodline{|}{ \lambda \ottmv{x} .\, \epsilon }{}{\textsf{bind}\; \ottmv{x}\; \textsf{in}\; \epsilon}{}{\ottcom{abstractions}}\ottprodnewline
\ottprodline{|}{ \ottkw{fix} ~ \ottmv{x} .\, \epsilon }{}{\textsf{bind}\; \ottmv{x}\; \textsf{in}\; \epsilon}{}{\ottcom{fixpoint}}\ottprodnewline
\ottprodline{|}{\epsilon_{{\mathrm{1}}} \, \epsilon_{{\mathrm{2}}}}{}{}{}{\ottcom{applications}}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ell_{{\mathrm{1}}}  \Mapsto  \epsilon_{{\mathrm{1}}}  ; \, \, .. \, ; \,  \ell_{\ottmv{n}}  \Mapsto  \epsilon_{\ottmv{n}}  \ottsym{\}}}{}{}{}{\ottcom{records}}\ottprodnewline
\ottprodline{|}{\epsilon_{{\mathrm{1}}}  \ottsym{.}  \ell}{}{}{}{\ottcom{projection}}\ottprodnewline
\ottprodline{|}{\epsilon_{{\mathrm{1}}}  \,{+}\!{+}\,  \epsilon_{{\mathrm{2}}}}{}{}{}{\ottcom{concatenation}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \epsilon  \ottsym{)}} {\textsf{S}}{}{}{}\ottprodnewline
\ottprodline{|}{ c\, \epsilon }{}{}{}{}}

\newcommand{\otttctx}{
\ottrulehead{\ottnt{tctx}  ,\ \Delta}{::=}{\ottcom{typing context}}\ottprodnewline
\ottfirstprodline{|}{ \cdot }{}{}{}{\ottcom{empty context}}\ottprodnewline
\ottprodline{|}{\Delta  \ottsym{,}  \ottmv{x}  :  \mathcal{A}}{}{}{}{\ottcom{assumption}}}

\newcommand{\ottgrammar}{\ottgrammartabular{
\otttyp\ottinterrule
\ottexp\ottinterrule
\ottctx\ottinterrule
\ottdirflag\ottinterrule
\ottrcdtyp\ottinterrule
\ottttyp\ottinterrule
\otttindx\ottinterrule
\otttexp\ottinterrule
\otttctx\ottafterlastrule
}}

% defnss
% defns TopLikeType
%% defn toplike
\newcommand{\ottdruleTLXXTop}[1]{\ottdrule[#1]{%
}{
 \rceil  \top  \lceil }{%
{\ottdrulename{TL\_Top}}{}%
}}


\newcommand{\ottdruleTLXXAnd}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil \ottnt{A} \lceil }%
\ottpremise{ \rceil \ottnt{B} \lceil }%
}{
 \rceil \ottnt{A}  \, {\&} \,  \ottnt{B} \lceil }{%
{\ottdrulename{TL\_And}}{}%
}}


\newcommand{\ottdruleTLXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil \ottnt{B} \lceil }%
}{
 \rceil \ottnt{A}  \rightarrow  \ottnt{B} \lceil }{%
{\ottdrulename{TL\_Arrow}}{}%
}}


\newcommand{\ottdruleTLXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil \ottnt{B} \lceil }%
}{
 \rceil \ottsym{\{}  \ell  :  \ottnt{B}  \ottsym{\}} \lceil }{%
{\ottdrulename{TL\_Rcd}}{}%
}}

\newcommand{\ottdefntoplike}[1]{\begin{ottdefnblock}[#1]{$ \rceil \ottnt{A} \lceil $}{\ottcom{Top-like types}}
\ottusedrule{\ottdruleTLXXTop{}}
\ottusedrule{\ottdruleTLXXAnd{}}
\ottusedrule{\ottdruleTLXXArrow{}}
\ottusedrule{\ottdruleTLXXRcd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsTopLikeType}{
\ottdefntoplike{}}

% defns SplitType
%% defn spl
\newcommand{\ottdruleSpXXAnd}[1]{\ottdrule[#1]{%
}{
 \ottnt{A} \,\lhd\, \ottnt{A}  \, {\&} \,  \ottnt{B} \,\rhd\, \ottnt{B} }{%
{\ottdrulename{Sp\_And}}{}%
}}


\newcommand{\ottdruleSpXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{B_{{\mathrm{1}}}} \,\lhd\, \ottnt{B} \,\rhd\, \ottnt{B_{{\mathrm{2}}}} }%
}{
 \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{1}}}} \,\lhd\, \ottnt{A}  \rightarrow  \ottnt{B} \,\rhd\, \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{2}}}} }{%
{\ottdrulename{Sp\_Arrow}}{}%
}}


\newcommand{\ottdruleSpXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{B_{{\mathrm{1}}}} \,\lhd\, \ottnt{B} \,\rhd\, \ottnt{B_{{\mathrm{2}}}} }%
}{
 \ottsym{\{}  \ell  :  \ottnt{B_{{\mathrm{1}}}}  \ottsym{\}} \,\lhd\, \ottsym{\{}  \ell  :  \ottnt{B}  \ottsym{\}} \,\rhd\, \ottsym{\{}  \ell  :  \ottnt{B_{{\mathrm{2}}}}  \ottsym{\}} }{%
{\ottdrulename{Sp\_Rcd}}{}%
}}

\newcommand{\ottdefnspl}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{B} \,\lhd\, \ottnt{A} \,\rhd\, \ottnt{C} $}{\ottcom{Type splitting}}
\ottusedrule{\ottdruleSpXXAnd{}}
\ottusedrule{\ottdruleSpXXArrow{}}
\ottusedrule{\ottdruleSpXXRcd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsSplitType}{
\ottdefnspl{}}

% defns OrdinaryType
%% defn ord
\newcommand{\ottdruleOXXTop}[1]{\ottdrule[#1]{%
}{
  \top  ~ \mathsf{Ordinary} }{%
{\ottdrulename{O\_Top}}{}%
}}


\newcommand{\ottdruleOXXInt}[1]{\ottdrule[#1]{%
}{
  \mathbb{Z}  ~ \mathsf{Ordinary} }{%
{\ottdrulename{O\_Int}}{}%
}}


\newcommand{\ottdruleOXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{B} ~ \mathsf{Ordinary} }%
}{
 \ottnt{A}  \rightarrow  \ottnt{B} ~ \mathsf{Ordinary} }{%
{\ottdrulename{O\_Arrow}}{}%
}}


\newcommand{\ottdruleOXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{B} ~ \mathsf{Ordinary} }%
}{
 \ottsym{\{}  \ell  :  \ottnt{B}  \ottsym{\}} ~ \mathsf{Ordinary} }{%
{\ottdrulename{O\_Rcd}}{}%
}}

\newcommand{\ottdefnord}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{A} ~ \mathsf{Ordinary} $}{\ottcom{Ordinary types}}
\ottusedrule{\ottdruleOXXTop{}}
\ottusedrule{\ottdruleOXXInt{}}
\ottusedrule{\ottdruleOXXArrow{}}
\ottusedrule{\ottdruleOXXRcd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsOrdinaryType}{
\ottdefnord{}}

% defns Disjoint
%% defn disjoint
\newcommand{\ottdruleDXXSymm}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{B}  *  \ottnt{A}}%
}{
\ottnt{A}  *  \ottnt{B}}{%
{\ottdrulename{D\_Symm}}{}%
}}


\newcommand{\ottdruleDXXTopL}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil \ottnt{A} \lceil }%
}{
\ottnt{A}  *  \ottnt{B}}{%
{\ottdrulename{D\_TopL}}{}%
}}


\newcommand{\ottdruleDXXAndL}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{A_{{\mathrm{1}}}}  *  \ottnt{B}}%
\ottpremise{\ottnt{A_{{\mathrm{2}}}}  *  \ottnt{B}}%
}{
\ottnt{A_{{\mathrm{1}}}}  \, {\&} \,  \ottnt{A_{{\mathrm{2}}}}  *  \ottnt{B}}{%
{\ottdrulename{D\_AndL}}{}%
}}


\newcommand{\ottdruleDXXIntArrow}[1]{\ottdrule[#1]{%
}{
 \mathbb{Z}   *  \ottnt{A_{{\mathrm{1}}}}  \rightarrow  \ottnt{A_{{\mathrm{2}}}}}{%
{\ottdrulename{D\_IntArrow}}{}%
}}


\newcommand{\ottdruleDXXIntRcd}[1]{\ottdrule[#1]{%
}{
 \mathbb{Z}   *  \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}}}{%
{\ottdrulename{D\_IntRcd}}{}%
}}


\newcommand{\ottdruleDXXArrowArrow}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{A_{{\mathrm{2}}}}  *  \ottnt{B_{{\mathrm{2}}}}}%
}{
\ottnt{A_{{\mathrm{1}}}}  \rightarrow  \ottnt{A_{{\mathrm{2}}}}  *  \ottnt{B_{{\mathrm{1}}}}  \rightarrow  \ottnt{B_{{\mathrm{2}}}}}{%
{\ottdrulename{D\_ArrowArrow}}{}%
}}


\newcommand{\ottdruleDXXRcdEq}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{A}  *  \ottnt{B}}%
}{
\ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}}  *  \ottsym{\{}  \ell  :  \ottnt{B}  \ottsym{\}}}{%
{\ottdrulename{D\_RcdEq}}{}%
}}


\newcommand{\ottdruleDXXRcdNeq}[1]{\ottdrule[#1]{%
\ottpremise{ \ell_{{\mathrm{1}}}  \neq  \ell_{{\mathrm{2}}} }%
}{
\ottsym{\{}  \ell_{{\mathrm{1}}}  :  \ottnt{A}  \ottsym{\}}  *  \ottsym{\{}  \ell_{{\mathrm{2}}}  :  \ottnt{B}  \ottsym{\}}}{%
{\ottdrulename{D\_RcdNeq}}{}%
}}


\newcommand{\ottdruleDXXArrowRcd}[1]{\ottdrule[#1]{%
}{
\ottnt{A_{{\mathrm{1}}}}  \rightarrow  \ottnt{A_{{\mathrm{2}}}}  *  \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}}}{%
{\ottdrulename{D\_ArrowRcd}}{}%
}}

\newcommand{\ottdefndisjoint}[1]{\begin{ottdefnblock}[#1]{$\ottnt{A}  *  \ottnt{B}$}{\ottcom{Type disjointness}}
\ottusedrule{\ottdruleDXXSymm{}}
\ottusedrule{\ottdruleDXXTopL{}}
\ottusedrule{\ottdruleDXXAndL{}}
\ottusedrule{\ottdruleDXXIntArrow{}}
\ottusedrule{\ottdruleDXXIntRcd{}}
\ottusedrule{\ottdruleDXXArrowArrow{}}
\ottusedrule{\ottdruleDXXRcdEq{}}
\ottusedrule{\ottdruleDXXRcdNeq{}}
\ottusedrule{\ottdruleDXXArrowRcd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsDisjoint}{
\ottdefndisjoint{}}

% defns RSubtyping
%% defn sub
\newcommand{\ottdruleRSXXInt}[1]{\ottdrule[#1]{%
}{
  \mathbb{Z}   \sqsubseteq   \mathbb{Z}  }{%
{\ottdrulename{RS\_Int}}{}%
}}


\newcommand{\ottdruleRSXXTop}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil \ottnt{B} \lceil }%
}{
 \ottnt{A}  \sqsubseteq  \ottnt{B} }{%
{\ottdrulename{RS\_Top}}{}%
}}


\newcommand{\ottdruleRSXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{A_{{\mathrm{1}}}}  \fallingdotseq  \ottnt{B_{{\mathrm{1}}}} ~~~~\and~~~~ \ottnt{A_{{\mathrm{2}}}}  \fallingdotseq  \ottnt{B_{{\mathrm{2}}}} }%
}{
 \ottnt{A_{{\mathrm{1}}}}  \rightarrow  \ottnt{A_{{\mathrm{2}}}}  \sqsubseteq  \ottnt{B_{{\mathrm{1}}}}  \rightarrow  \ottnt{B_{{\mathrm{2}}}} }{%
{\ottdrulename{RS\_Arrow}}{}%
}}


\newcommand{\ottdruleRSXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{A}  \fallingdotseq  \ottnt{B}}%
}{
 \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}}  \sqsubseteq  \ottsym{\{}  \ell  :  \ottnt{B}  \ottsym{\}} }{%
{\ottdrulename{RS\_Rcd}}{}%
}}


\newcommand{\ottdruleRSXXAndLOne}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{A_{{\mathrm{1}}}}  \sqsubseteq  \ottnt{A_{{\mathrm{3}}}} }%
}{
 \ottnt{A_{{\mathrm{1}}}}  \, {\&} \,  \ottnt{A_{{\mathrm{2}}}}  \sqsubseteq  \ottnt{A_{{\mathrm{3}}}} }{%
{\ottdrulename{RS\_AndL1}}{}%
}}


\newcommand{\ottdruleRSXXAndLTwo}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{A_{{\mathrm{2}}}}  \sqsubseteq  \ottnt{A_{{\mathrm{3}}}} }%
}{
 \ottnt{A_{{\mathrm{1}}}}  \, {\&} \,  \ottnt{A_{{\mathrm{2}}}}  \sqsubseteq  \ottnt{A_{{\mathrm{3}}}} }{%
{\ottdrulename{RS\_AndL2}}{}%
}}


\newcommand{\ottdruleRSXXAndR}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{A_{{\mathrm{1}}}}  \sqsubseteq  \ottnt{A_{{\mathrm{2}}}} }%
\ottpremise{ \ottnt{A_{{\mathrm{1}}}}  \sqsubseteq  \ottnt{A_{{\mathrm{3}}}} }%
}{
 \ottnt{A_{{\mathrm{1}}}}  \sqsubseteq  \ottnt{A_{{\mathrm{2}}}}  \, {\&} \,  \ottnt{A_{{\mathrm{3}}}} }{%
{\ottdrulename{RS\_AndR}}{}%
}}

\newcommand{\ottdefnsub}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{A}  \sqsubseteq  \ottnt{B} $}{\ottcom{Width subtyping}}
\ottusedrule{\ottdruleRSXXInt{}}
\ottusedrule{\ottdruleRSXXTop{}}
\ottusedrule{\ottdruleRSXXArrow{}}
\ottusedrule{\ottdruleRSXXRcd{}}
\ottusedrule{\ottdruleRSXXAndLOne{}}
\ottusedrule{\ottdruleRSXXAndLTwo{}}
\ottusedrule{\ottdruleRSXXAndR{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsRSubtyping}{
\ottdefnsub{}}

% defns CoMerge
%% defn comerge
\newcommand{\ottdruleMXXTop}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil \ottnt{C} \lceil }%
\ottpremise{ \ottnt{A} \,\lhd\, \ottnt{C} \,\rhd\, \ottnt{B} }%
}{
\epsilon_{{\mathrm{1}}}  :  \ottnt{A}  \,\rhd\,  \ottnt{C}  \,\lhd\,  \epsilon_{{\mathrm{2}}}  :  \ottnt{B}  \,\rightsquigarrow\,  \ottsym{\{}  \,  \ottsym{\}}}{%
{\ottdrulename{M\_Top}}{}%
}}


\newcommand{\ottdruleMXXAnd}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil \ottnt{A}  \, {\&} \,  \ottnt{B} \lceil  }%
}{
\epsilon_{{\mathrm{1}}}  :  \ottnt{A}  \,\rhd\,  \ottnt{A}  \, {\&} \,  \ottnt{B}  \,\lhd\,  \epsilon_{{\mathrm{2}}}  :  \ottnt{B}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{1}}}  \,{+}\!{+}\,  \epsilon_{{\mathrm{2}}}}{%
{\ottdrulename{M\_And}}{}%
}}


\newcommand{\ottdruleMXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil \ottnt{B_{{\mathrm{1}}}} \lceil  }%
\ottpremise{ \neg   \rceil \ottnt{B_{{\mathrm{2}}}} \lceil  }%
\ottpremise{\ottsym{(}  \epsilon_{{\mathrm{1}}}  \ottsym{.}   | \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{1}}}} |   \ottsym{)} \, \ottmv{x}  :  \ottnt{B_{{\mathrm{1}}}}  \,\rhd\,  \ottnt{B}  \,\lhd\,  \ottsym{(}  \epsilon_{{\mathrm{2}}}  \ottsym{.}   | \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{2}}}} |   \ottsym{)} \, \ottmv{x}  :  \ottnt{B_{{\mathrm{2}}}}  \,\rightsquigarrow\,  \epsilon}%
}{
\epsilon_{{\mathrm{1}}}  :  \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{1}}}}  \,\rhd\,  \ottnt{A}  \rightarrow  \ottnt{B}  \,\lhd\,  \epsilon_{{\mathrm{2}}}  :  \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{2}}}}  \,\rightsquigarrow\,  \ottsym{\{}   | \ottnt{A}  \rightarrow  \ottnt{B} |   \Mapsto   \lambda \ottmv{x} .\, \epsilon   \ottsym{\}}}{%
{\ottdrulename{M\_Arrow}}{}%
}}


\newcommand{\ottdruleMXXArrowL}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil \ottnt{B_{{\mathrm{1}}}} \lceil  }%
\ottpremise{ \rceil \ottnt{B_{{\mathrm{2}}}} \lceil }%
\ottpremise{\ottsym{(}  \epsilon_{{\mathrm{1}}}  \ottsym{.}   | \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{1}}}} |   \ottsym{)} \, \ottmv{x}  :  \ottnt{B_{{\mathrm{1}}}}  \,\rhd\,  \ottnt{B}  \,\lhd\,  \ottsym{\{}  \,  \ottsym{\}}  :  \ottnt{B_{{\mathrm{2}}}}  \,\rightsquigarrow\,  \epsilon}%
}{
\epsilon_{{\mathrm{1}}}  :  \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{1}}}}  \,\rhd\,  \ottnt{A}  \rightarrow  \ottnt{B}  \,\lhd\,  \epsilon_{{\mathrm{2}}}  :  \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{2}}}}  \,\rightsquigarrow\,  \ottsym{\{}   | \ottnt{A}  \rightarrow  \ottnt{B} |   \Mapsto   \lambda \ottmv{x} .\, \epsilon   \ottsym{\}}}{%
{\ottdrulename{M\_ArrowL}}{}%
}}


\newcommand{\ottdruleMXXArrowR}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil \ottnt{B_{{\mathrm{1}}}} \lceil }%
\ottpremise{ \neg   \rceil \ottnt{B_{{\mathrm{2}}}} \lceil  }%
\ottpremise{\ottsym{\{}  \,  \ottsym{\}}  :  \ottnt{B_{{\mathrm{1}}}}  \,\rhd\,  \ottnt{B}  \,\lhd\,  \ottsym{(}  \epsilon_{{\mathrm{2}}}  \ottsym{.}   | \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{2}}}} |   \ottsym{)} \, \ottmv{x}  :  \ottnt{B_{{\mathrm{2}}}}  \,\rightsquigarrow\,  \epsilon}%
}{
\epsilon_{{\mathrm{1}}}  :  \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{1}}}}  \,\rhd\,  \ottnt{A}  \rightarrow  \ottnt{B}  \,\lhd\,  \epsilon_{{\mathrm{2}}}  :  \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{2}}}}  \,\rightsquigarrow\,  \ottsym{\{}   | \ottnt{A}  \rightarrow  \ottnt{B} |   \Mapsto   \lambda \ottmv{x} .\, \epsilon   \ottsym{\}}}{%
{\ottdrulename{M\_ArrowR}}{}%
}}


\newcommand{\ottdruleMXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil \ottnt{A_{{\mathrm{1}}}} \lceil  }%
\ottpremise{ \neg   \rceil \ottnt{A_{{\mathrm{2}}}} \lceil  }%
\ottpremise{\epsilon_{{\mathrm{1}}}  \ottsym{.}   | \ottsym{\{}  \ell  :  \ottnt{A_{{\mathrm{1}}}}  \ottsym{\}} |   :  \ottnt{A_{{\mathrm{1}}}}  \,\rhd\,  \ottnt{A}  \,\lhd\,  \epsilon_{{\mathrm{2}}}  \ottsym{.}   | \ottsym{\{}  \ell  :  \ottnt{A_{{\mathrm{2}}}}  \ottsym{\}} |   :  \ottnt{A_{{\mathrm{2}}}}  \,\rightsquigarrow\,  \epsilon}%
}{
\epsilon_{{\mathrm{1}}}  :  \ottsym{\{}  \ell  :  \ottnt{A_{{\mathrm{1}}}}  \ottsym{\}}  \,\rhd\,  \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}}  \,\lhd\,  \epsilon_{{\mathrm{2}}}  :  \ottsym{\{}  \ell  :  \ottnt{A_{{\mathrm{2}}}}  \ottsym{\}}  \,\rightsquigarrow\,  \ottsym{\{}   | \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}} |   \Mapsto  \epsilon  \ottsym{\}}}{%
{\ottdrulename{M\_Rcd}}{}%
}}


\newcommand{\ottdruleMXXRcdL}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil \ottnt{A_{{\mathrm{1}}}} \lceil  }%
\ottpremise{ \rceil \ottnt{A_{{\mathrm{2}}}} \lceil }%
\ottpremise{\epsilon_{{\mathrm{1}}}  \ottsym{.}   | \ottsym{\{}  \ell  :  \ottnt{A_{{\mathrm{1}}}}  \ottsym{\}} |   :  \ottnt{A_{{\mathrm{1}}}}  \,\rhd\,  \ottnt{A}  \,\lhd\,  \ottsym{\{}  \,  \ottsym{\}}  :  \ottnt{A_{{\mathrm{2}}}}  \,\rightsquigarrow\,  \epsilon}%
}{
\epsilon_{{\mathrm{1}}}  :  \ottsym{\{}  \ell  :  \ottnt{A_{{\mathrm{1}}}}  \ottsym{\}}  \,\rhd\,  \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}}  \,\lhd\,  \epsilon_{{\mathrm{2}}}  :  \ottsym{\{}  \ell  :  \ottnt{A_{{\mathrm{2}}}}  \ottsym{\}}  \,\rightsquigarrow\,  \ottsym{\{}   | \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}} |   \Mapsto  \epsilon  \ottsym{\}}}{%
{\ottdrulename{M\_RcdL}}{}%
}}


\newcommand{\ottdruleMXXRcdR}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil \ottnt{A_{{\mathrm{1}}}} \lceil }%
\ottpremise{ \neg   \rceil \ottnt{A_{{\mathrm{2}}}} \lceil  }%
\ottpremise{\ottsym{\{}  \,  \ottsym{\}}  :  \ottnt{A_{{\mathrm{1}}}}  \,\rhd\,  \ottnt{A}  \,\lhd\,  \epsilon_{{\mathrm{2}}}  \ottsym{.}   | \ottsym{\{}  \ell  :  \ottnt{A_{{\mathrm{2}}}}  \ottsym{\}} |   :  \ottnt{A_{{\mathrm{2}}}}  \,\rightsquigarrow\,  \epsilon}%
}{
\epsilon_{{\mathrm{1}}}  :  \ottsym{\{}  \ell  :  \ottnt{A_{{\mathrm{1}}}}  \ottsym{\}}  \,\rhd\,  \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}}  \,\lhd\,  \epsilon_{{\mathrm{2}}}  :  \ottsym{\{}  \ell  :  \ottnt{A_{{\mathrm{2}}}}  \ottsym{\}}  \,\rightsquigarrow\,  \ottsym{\{}   | \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}} |   \Mapsto  \epsilon  \ottsym{\}}}{%
{\ottdrulename{M\_RcdR}}{}%
}}

\newcommand{\ottdefncomerge}[1]{\begin{ottdefnblock}[#1]{$\epsilon_{{\mathrm{1}}}  :  \ottnt{A}  \,\rhd\,  \ottnt{C}  \,\lhd\,  \epsilon_{{\mathrm{2}}}  :  \ottnt{B}  \,\rightsquigarrow\,  \epsilon$}{\ottcom{Coercive merging}}
\ottusedrule{\ottdruleMXXTop{}}
\ottusedrule{\ottdruleMXXAnd{}}
\ottusedrule{\ottdruleMXXArrow{}}
\ottusedrule{\ottdruleMXXArrowL{}}
\ottusedrule{\ottdruleMXXArrowR{}}
\ottusedrule{\ottdruleMXXRcd{}}
\ottusedrule{\ottdruleMXXRcdL{}}
\ottusedrule{\ottdruleMXXRcdR{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsCoMerge}{
\ottdefncomerge{}}

% defns CoSubtyping
%% defn cosub
\newcommand{\ottdruleSXXTop}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil B^\circ \lceil }%
}{
\epsilon  :  \ottnt{A}  \ottsym{<:}  B^\circ  \,\rightsquigarrow\,  \ottsym{\{}  \,  \ottsym{\}}}{%
{\ottdrulename{S\_Top}}{}%
}}


\newcommand{\ottdruleSXXInt}[1]{\ottdrule[#1]{%
}{
\epsilon  :   \mathbb{Z}   \ottsym{<:}   \mathbb{Z}   \,\rightsquigarrow\,  \ottsym{\{}   \overline{\mathbb{Z} }   \Mapsto  \epsilon  \ottsym{.}   \overline{\mathbb{Z} }   \ottsym{\}}}{%
{\ottdrulename{S\_Int}}{}%
}}


\newcommand{\ottdruleSXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil B^\circ_{{\mathrm{2}}} \lceil  }%
\ottpremise{\ottmv{x}  :  \ottnt{B_{{\mathrm{1}}}}  \ottsym{<:}  \ottnt{A_{{\mathrm{1}}}}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{1}}}}%
\ottpremise{\ottsym{(}  \epsilon  \ottsym{.}   | \ottnt{A_{{\mathrm{1}}}}  \rightarrow  \ottnt{A_{{\mathrm{2}}}} |   \ottsym{)} \, \epsilon_{{\mathrm{1}}}  :  \ottnt{A_{{\mathrm{2}}}}  \ottsym{<:}  B^\circ_{{\mathrm{2}}}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{2}}}}%
}{
\epsilon  :  \ottnt{A_{{\mathrm{1}}}}  \rightarrow  \ottnt{A_{{\mathrm{2}}}}  \ottsym{<:}  \ottnt{B_{{\mathrm{1}}}}  \rightarrow  B^\circ_{{\mathrm{2}}}  \,\rightsquigarrow\,  \ottsym{\{}   | \ottnt{B_{{\mathrm{1}}}}  \rightarrow  B^\circ_{{\mathrm{2}}} |   \Mapsto   \lambda \ottmv{x} .\, \epsilon_{{\mathrm{2}}}   \ottsym{\}}}{%
{\ottdrulename{S\_Arrow}}{}%
}}


\newcommand{\ottdruleSXXAndL}[1]{\ottdrule[#1]{%
\ottpremise{\epsilon  :  \ottnt{A}  \ottsym{<:}  C^\circ  \,\rightsquigarrow\,  \epsilon'}%
}{
\epsilon  :  \ottnt{A}  \, {\&} \,  \ottnt{B}  \ottsym{<:}  C^\circ  \,\rightsquigarrow\,  \epsilon'}{%
{\ottdrulename{S\_AndL}}{}%
}}


\newcommand{\ottdruleSXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{  \neg   \rceil B^\circ \lceil   \enspace\and\enspace \epsilon  \ottsym{.}   | \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}} |   :  \ottnt{A}  \ottsym{<:}  B^\circ  \,\rightsquigarrow\,  \epsilon_{{\mathrm{2}}} }%
}{
\epsilon  :  \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}}  \ottsym{<:}  \ottsym{\{}  \ell  :  B^\circ  \ottsym{\}}  \,\rightsquigarrow\,  \ottsym{\{}   | \ottsym{\{}  \ell  :  B^\circ  \ottsym{\}} |   \Mapsto  \epsilon_{{\mathrm{2}}}  \ottsym{\}}}{%
{\ottdrulename{S\_Rcd}}{}%
}}


\newcommand{\ottdruleSXXAndR}[1]{\ottdrule[#1]{%
\ottpremise{\epsilon  :  \ottnt{B}  \ottsym{<:}  C^\circ  \,\rightsquigarrow\,  \epsilon'}%
}{
\epsilon  :  \ottnt{A}  \, {\&} \,  \ottnt{B}  \ottsym{<:}  C^\circ  \,\rightsquigarrow\,  \epsilon'}{%
{\ottdrulename{S\_AndR}}{}%
}}


\newcommand{\ottdruleSXXSplit}[1]{\ottdrule[#1]{%
\ottpremise{    \ottnt{B_{{\mathrm{1}}}} \,\lhd\, \ottnt{B} \,\rhd\, \ottnt{B_{{\mathrm{2}}}}  \enspace\and\enspace \epsilon  :  \ottnt{A}  \ottsym{<:}  \ottnt{B_{{\mathrm{1}}}}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{1}}}  \enspace\and\enspace \epsilon  :  \ottnt{A}  \ottsym{<:}  \ottnt{B_{{\mathrm{2}}}}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{2}}}  \enspace\and\enspace \epsilon_{{\mathrm{1}}}  :  \ottnt{B_{{\mathrm{1}}}}  \,\rhd\,  \ottnt{B}  \,\lhd\,  \epsilon_{{\mathrm{2}}}  :  \ottnt{B_{{\mathrm{2}}}}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{3}}} }%
}{
\epsilon  :  \ottnt{A}  \ottsym{<:}  \ottnt{B}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{3}}}}{%
{\ottdrulename{S\_Split}}{}%
}}

\newcommand{\ottdefncosub}[1]{\begin{ottdefnblock}[#1]{$\epsilon_{{\mathrm{1}}}  :  \ottnt{A}  \ottsym{<:}  \ottnt{B}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{2}}}$}{\ottcom{Coercive subtyping}}
\ottusedrule{\ottdruleSXXTop{}}
\ottusedrule{\ottdruleSXXInt{}}
\ottusedrule{\ottdruleSXXArrow{}}
\ottusedrule{\ottdruleSXXAndL{}}
\ottusedrule{\ottdruleSXXRcd{}}
\ottusedrule{\ottdruleSXXAndR{}}
\ottusedrule{\ottdruleSXXSplit{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsCoSubtyping}{
\ottdefncosub{}}

% defns Projection
%% defn proj
\newcommand{\ottdrulePXXTop}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil \ottnt{A} \lceil }%
}{
 \epsilon_{{\mathrm{1}}}   :   \ottnt{A}  \,\bullet  \ottsym{\{}   \ell   \ottsym{\}}  \! \,\rightsquigarrow\,   \ottsym{\{}  \,  \ottsym{\}}   :    \top  }{%
{\ottdrulename{P\_Top}}{}%
}}


\newcommand{\ottdrulePXXRcdEq}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil \ottnt{A} \lceil  }%
}{
 \epsilon   :   \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}}  \,\bullet  \ottsym{\{}   \ell   \ottsym{\}}  \! \,\rightsquigarrow\,   \epsilon  \ottsym{.}   | \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}} |    :   \ottnt{A} }{%
{\ottdrulename{P\_RcdEq}}{}%
}}


\newcommand{\ottdrulePXXRcdNeq}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil \ottnt{A} \lceil  }%
\ottpremise{ \ell_{{\mathrm{1}}}  \neq  \ell_{{\mathrm{2}}} }%
}{
 \epsilon   :   \ottsym{\{}  \ell_{{\mathrm{1}}}  :  \ottnt{A}  \ottsym{\}}  \,\bullet  \ottsym{\{}   \ell_{{\mathrm{2}}}   \ottsym{\}}  \! \,\rightsquigarrow\,   \ottsym{\{}  \,  \ottsym{\}}   :    \top  }{%
{\ottdrulename{P\_RcdNeq}}{}%
}}


\newcommand{\ottdrulePXXAnd}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil \ottnt{A}  \, {\&} \,  \ottnt{B} \lceil  }%
\ottpremise{ \epsilon_{{\mathrm{1}}}   :   \ottnt{A}  \,\bullet  \ottsym{\{}   \ell   \ottsym{\}}  \! \,\rightsquigarrow\,   \epsilon_{{\mathrm{2}}}   :   \ottnt{A'} }%
\ottpremise{ \epsilon_{{\mathrm{1}}}   :   \ottnt{B}  \,\bullet  \ottsym{\{}   \ell   \ottsym{\}}  \! \,\rightsquigarrow\,   \epsilon_{{\mathrm{3}}}   :   \ottnt{B'} }%
}{
 \epsilon_{{\mathrm{1}}}   :   \ottnt{A}  \, {\&} \,  \ottnt{B}  \,\bullet  \ottsym{\{}   \ell   \ottsym{\}}  \! \,\rightsquigarrow\,   \epsilon_{{\mathrm{2}}}  \,{+}\!{+}\,  \epsilon_{{\mathrm{3}}}   :   \ottnt{A'}  \, {\&} \,  \ottnt{B'} }{%
{\ottdrulename{P\_And}}{}%
}}

\newcommand{\ottdefnproj}[1]{\begin{ottdefnblock}[#1]{$ \epsilon_{{\mathrm{1}}}   :   \ottnt{A}  \,\bullet  \ottsym{\{}   \ell   \ottsym{\}}  \! \,\rightsquigarrow\,   \epsilon_{{\mathrm{3}}}   :   \ottnt{C} $}{\ottcom{Distributive projection}}
\ottusedrule{\ottdrulePXXTop{}}
\ottusedrule{\ottdrulePXXRcdEq{}}
\ottusedrule{\ottdrulePXXRcdNeq{}}
\ottusedrule{\ottdrulePXXAnd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsProjection}{
\ottdefnproj{}}

% defns DistributiveApplication
%% defn distapp
\newcommand{\ottdruleAXXTop}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil \ottnt{A} \lceil }%
}{
 \epsilon_{{\mathrm{1}}}   :   \ottnt{A}  \,\bullet\,  \epsilon_{{\mathrm{2}}}   :   \ottnt{B}   \,\rightsquigarrow\,   \ottsym{\{}  \,  \ottsym{\}}   :    \top  }{%
{\ottdrulename{A\_Top}}{}%
}}


\newcommand{\ottdruleAXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil \ottnt{B} \lceil  }%
\ottpremise{\epsilon_{{\mathrm{2}}}  :  \ottnt{C}  \ottsym{<:}  \ottnt{A}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{3}}}}%
}{
 \epsilon_{{\mathrm{1}}}   :   \ottnt{A}  \rightarrow  \ottnt{B}  \,\bullet\,  \epsilon_{{\mathrm{2}}}   :   \ottnt{C}   \,\rightsquigarrow\,   \ottsym{(}  \epsilon_{{\mathrm{1}}}  \ottsym{.}   | \ottnt{A}  \rightarrow  \ottnt{B} |   \ottsym{)} \, \epsilon_{{\mathrm{3}}}   :   \ottnt{B} }{%
{\ottdrulename{A\_Arrow}}{}%
}}


\newcommand{\ottdruleAXXAnd}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil \ottnt{A}  \, {\&} \,  \ottnt{B} \lceil  }%
\ottpremise{  \epsilon_{{\mathrm{1}}}   :   \ottnt{A}  \,\bullet\,  \epsilon_{{\mathrm{2}}}   :   \ottnt{C}   \,\rightsquigarrow\,   \epsilon_{{\mathrm{3}}}   :   \ottnt{A'}  \enspace\and\enspace  \epsilon_{{\mathrm{1}}}   :   \ottnt{B}  \,\bullet\,  \epsilon_{{\mathrm{2}}}   :   \ottnt{C}   \,\rightsquigarrow\,   \epsilon_{{\mathrm{4}}}   :   \ottnt{B'}  }%
}{
 \epsilon_{{\mathrm{1}}}   :   \ottnt{A}  \, {\&} \,  \ottnt{B}  \,\bullet\,  \epsilon_{{\mathrm{2}}}   :   \ottnt{C}   \,\rightsquigarrow\,   \epsilon_{{\mathrm{3}}}  \,{+}\!{+}\,  \epsilon_{{\mathrm{4}}}   :   \ottnt{A'}  \, {\&} \,  \ottnt{B'} }{%
{\ottdrulename{A\_And}}{}%
}}

\newcommand{\ottdefndistapp}[1]{\begin{ottdefnblock}[#1]{$ \epsilon_{{\mathrm{1}}}   :   \ottnt{A}  \,\bullet\,  \epsilon_{{\mathrm{2}}}   :   \ottnt{B}   \,\rightsquigarrow\,   \epsilon_{{\mathrm{3}}}   :   \ottnt{C} $}{\ottcom{Distributive application}}
\ottusedrule{\ottdruleAXXTop{}}
\ottusedrule{\ottdruleAXXArrow{}}
\ottusedrule{\ottdruleAXXAnd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsDistributiveApplication}{
\ottdefndistapp{}}

% defns Elaboration
%% defn elaboration
\newcommand{\ottdruleElaXXTop}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash   \top  \, \Rightarrow \,  \top   \,\rightsquigarrow\,  \ottsym{\{}  \,  \ottsym{\}}}{%
{\ottdrulename{Ela\_Top}}{}%
}}


\newcommand{\ottdruleElaXXTopAbs}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil \ottnt{B} \lceil }%
}{
\Gamma  \vdash   \lambda \ottmv{x} .\, \ottnt{e} : \ottnt{A} \rightarrow \ottnt{B}  \, \Rightarrow \, \ottnt{A}  \rightarrow  \ottnt{B}  \,\rightsquigarrow\,  \ottsym{\{}  \,  \ottsym{\}}}{%
{\ottdrulename{Ela\_TopAbs}}{}%
}}


\newcommand{\ottdruleElaXXTopRcd}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}  \,\rightsquigarrow\,  \epsilon}%
\ottpremise{ \rceil \ottnt{A} \lceil }%
}{
\Gamma  \vdash  \ottsym{\{}  \ell  \ottsym{=}  \ottnt{e}  \ottsym{\}} \, \Rightarrow \, \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}}  \,\rightsquigarrow\,  \ottsym{\{}  \,  \ottsym{\}}}{%
{\ottdrulename{Ela\_TopRcd}}{}%
}}


\newcommand{\ottdruleElaXXInt}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottmv{n} \, \Rightarrow \,  \mathbb{Z}   \,\rightsquigarrow\,  \ottsym{\{}   \overline{\mathbb{Z} }   \Mapsto  \ottmv{n}  \ottsym{\}}}{%
{\ottdrulename{Ela\_Int}}{}%
}}


\newcommand{\ottdruleElaXXVar}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  :  \ottnt{A} \, \in \, \Gamma}%
}{
\Gamma  \vdash  \ottmv{x} \, \Rightarrow \, \ottnt{A}  \,\rightsquigarrow\,  \ottmv{x}}{%
{\ottdrulename{Ela\_Var}}{}%
}}


\newcommand{\ottdruleElaXXAbs}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil \ottnt{B} \lceil  }%
\ottpremise{\Gamma  \ottsym{,}  \ottmv{x}  :  \ottnt{A}  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{B}  \,\rightsquigarrow\,  \epsilon}%
}{
\Gamma  \vdash   \lambda \ottmv{x} .\, \ottnt{e} : \ottnt{A} \rightarrow \ottnt{B}  \, \Rightarrow \, \ottnt{A}  \rightarrow  \ottnt{B}  \,\rightsquigarrow\,  \ottsym{\{}   | \ottnt{A}  \rightarrow  \ottnt{B} |   \Mapsto   \lambda \ottmv{x} .\, \epsilon   \ottsym{\}}}{%
{\ottdrulename{Ela\_Abs}}{}%
}}


\newcommand{\ottdruleElaXXSub}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{1}}}}%
\ottpremise{\epsilon_{{\mathrm{1}}}  :  \ottnt{A}  \ottsym{<:}  \ottnt{B}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{2}}}}%
}{
\Gamma  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{B}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{2}}}}{%
{\ottdrulename{Ela\_Sub}}{}%
}}


\newcommand{\ottdruleElaXXApp}[1]{\ottdrule[#1]{%
\ottpremise{ \Gamma  \vdash  \ottnt{e_{{\mathrm{1}}}} \, \Rightarrow \, \ottnt{A}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{1}}} \enspace\and\enspace \Gamma  \vdash  \ottnt{e_{{\mathrm{2}}}} \, \Rightarrow \, \ottnt{B}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{2}}} }%
\ottpremise{ \epsilon_{{\mathrm{1}}}   :   \ottnt{A}  \,\bullet\,  \epsilon_{{\mathrm{2}}}   :   \ottnt{B}   \,\rightsquigarrow\,   \epsilon_{{\mathrm{3}}}   :   \ottnt{C} }%
}{
\Gamma  \vdash  \ottnt{e_{{\mathrm{1}}}} \, \ottnt{e_{{\mathrm{2}}}} \, \Rightarrow \, \ottnt{C}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{3}}}}{%
{\ottdrulename{Ela\_App}}{}%
}}


\newcommand{\ottdruleElaXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil \ottnt{A} \lceil  }%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}  \,\rightsquigarrow\,  \epsilon}%
}{
\Gamma  \vdash  \ottsym{\{}  \ell  \ottsym{=}  \ottnt{e}  \ottsym{\}} \, \Rightarrow \, \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}}  \,\rightsquigarrow\,  \ottsym{\{}   | \ottsym{\{}  \ell  :  \ottnt{A}  \ottsym{\}} |   \Mapsto  \epsilon  \ottsym{\}}}{%
{\ottdrulename{Ela\_Rcd}}{}%
}}


\newcommand{\ottdruleElaXXProj}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{1}}}}%
\ottpremise{ \epsilon_{{\mathrm{1}}}   :   \ottnt{A}  \,\bullet  \ottsym{\{}   \ell   \ottsym{\}}  \! \,\rightsquigarrow\,   \epsilon_{{\mathrm{2}}}   :   \ottnt{B} }%
}{
\Gamma  \vdash  \ottnt{e}  \ottsym{.}  \ell \, \Rightarrow \, \ottnt{B}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{2}}}}{%
{\ottdrulename{Ela\_Proj}}{}%
}}


\newcommand{\ottdruleElaXXMerge}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e_{{\mathrm{1}}}} \, \Rightarrow \, \ottnt{A}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{1}}}}%
\ottpremise{\Gamma  \vdash  \ottnt{e_{{\mathrm{2}}}} \, \Rightarrow \, \ottnt{B}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{2}}}}%
\ottpremise{\ottnt{A}  *  \ottnt{B}}%
}{
\Gamma  \vdash  \ottnt{e_{{\mathrm{1}}}}  \bbcomma  \ottnt{e_{{\mathrm{2}}}} \, \Rightarrow \, \ottnt{A}  \, {\&} \,  \ottnt{B}  \,\rightsquigarrow\,  \epsilon_{{\mathrm{1}}}  \,{+}\!{+}\,  \epsilon_{{\mathrm{2}}}}{%
{\ottdrulename{Ela\_Merge}}{}%
}}


\newcommand{\ottdruleElaXXAnno}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{A}  \,\rightsquigarrow\,  \epsilon}%
}{
\Gamma  \vdash  \ottnt{e}  :  \ottnt{A} \, \Rightarrow \, \ottnt{A}  \,\rightsquigarrow\,  \epsilon}{%
{\ottdrulename{Ela\_Anno}}{}%
}}

\newcommand{\ottdefnelaboration}[1]{\begin{ottdefnblock}[#1]{$\Gamma  \vdash  \ottnt{e} \, \Leftrightarrow \, \ottnt{A}  \,\rightsquigarrow\,  \epsilon$}{\ottcom{Type-directed elaboration}}
\ottusedrule{\ottdruleElaXXTop{}}
\ottusedrule{\ottdruleElaXXTopAbs{}}
\ottusedrule{\ottdruleElaXXTopRcd{}}
\ottusedrule{\ottdruleElaXXInt{}}
\ottusedrule{\ottdruleElaXXVar{}}
\ottusedrule{\ottdruleElaXXAbs{}}
\ottusedrule{\ottdruleElaXXSub{}}
\ottusedrule{\ottdruleElaXXApp{}}
\ottusedrule{\ottdruleElaXXRcd{}}
\ottusedrule{\ottdruleElaXXProj{}}
\ottusedrule{\ottdruleElaXXMerge{}}
\ottusedrule{\ottdruleElaXXAnno{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsElaboration}{
\ottdefnelaboration{}}

% defns DunElaboration
%% defn dun_elaboration
\newcommand{\ottdruleDTypXXSub}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}  \,\rightsquigarrow\,  \epsilon}%
\ottpremise{ \ottnt{A}   \ottsym{<:}   \ottnt{B}   \,\rightsquigarrow\,  c }%
}{
\Gamma  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{B}  \,\rightsquigarrow\,   c\, \epsilon }{%
{\ottdrulename{DTyp\_Sub}}{}%
}}

\newcommand{\ottdefndunXXelaboration}[1]{\begin{ottdefnblock}[#1]{$\Gamma  \vdash  \ottnt{e} \, \Leftrightarrow \, \ottnt{A}  \,\rightsquigarrow\,  \epsilon$}{\ottcom{Typing rules in Dunfield's system}}
\ottusedrule{\ottdruleDTypXXSub{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsDunElaboration}{
\ottdefndunXXelaboration{}}

% defns Values
%% defn value
\newcommand{\ottdrulevalueXXunit}[1]{\ottdrule[#1]{%
}{
\ottkw{value} \, \ottsym{\{}  \,  \ottsym{\}}}{%
{\ottdrulename{value\_unit}}{}%
}}


\newcommand{\ottdrulevalueXXlit}[1]{\ottdrule[#1]{%
}{
\ottkw{value} \, \ottmv{n}}{%
{\ottdrulename{value\_lit}}{}%
}}


\newcommand{\ottdrulevalueXXabs}[1]{\ottdrule[#1]{%
}{
\ottkw{value} \,  \lambda \ottmv{x} .\, \epsilon }{%
{\ottdrulename{value\_abs}}{}%
}}


\newcommand{\ottdrulevalueXXrcd}[1]{\ottdrule[#1]{%
\ottpremise{\ottkw{value} \, \nu_{\ottmv{i}}}%
}{
\ottkw{value} \, \ottsym{\{}  \ell_{{\mathrm{1}}}  \Mapsto  \nu_{{\mathrm{1}}}  ; \, \, .. \, ; \,  \ell_{\ottmv{n}}  \Mapsto  \nu_{\ottmv{n}}  \ottsym{\}}}{%
{\ottdrulename{value\_rcd}}{}%
}}

\newcommand{\ottdefnvalue}[1]{\begin{ottdefnblock}[#1]{$\ottkw{value} \, \nu$}{\ottcom{Values}}
\ottusedrule{\ottdrulevalueXXunit{}}
\ottusedrule{\ottdrulevalueXXlit{}}
\ottusedrule{\ottdrulevalueXXabs{}}
\ottusedrule{\ottdrulevalueXXrcd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsValues}{
\ottdefnvalue{}}

% defns TargetStep
%% defn target_step
\newcommand{\ottdruleTStepXXProj}[1]{\ottdrule[#1]{%
\ottpremise{\epsilon  \rightarrow  \epsilon'}%
}{
\epsilon  \ottsym{.}  \ell  \rightarrow  \epsilon'  \ottsym{.}  \ell}{%
{\ottdrulename{TStep\_Proj}}{}%
}}


\newcommand{\ottdruleTStepXXAppL}[1]{\ottdrule[#1]{%
\ottpremise{\epsilon_{{\mathrm{1}}}  \rightarrow  \epsilon'_{{\mathrm{1}}}}%
}{
\epsilon_{{\mathrm{1}}} \, \epsilon_{{\mathrm{2}}}  \rightarrow  \epsilon'_{{\mathrm{1}}} \, \epsilon_{{\mathrm{2}}}}{%
{\ottdrulename{TStep\_AppL}}{}%
}}


\newcommand{\ottdruleTStepXXAppR}[1]{\ottdrule[#1]{%
\ottpremise{\epsilon  \rightarrow  \epsilon'}%
}{
\nu \, \epsilon  \rightarrow  \nu \, \epsilon'}{%
{\ottdrulename{TStep\_AppR}}{}%
}}


\newcommand{\ottdruleTStepXXConcatL}[1]{\ottdrule[#1]{%
\ottpremise{\epsilon_{{\mathrm{1}}}  \rightarrow  \epsilon'_{{\mathrm{1}}}}%
}{
\epsilon_{{\mathrm{1}}}  \,{+}\!{+}\,  \epsilon_{{\mathrm{2}}}  \rightarrow  \epsilon'_{{\mathrm{1}}}  \,{+}\!{+}\,  \epsilon_{{\mathrm{2}}}}{%
{\ottdrulename{TStep\_ConcatL}}{}%
}}


\newcommand{\ottdruleTStepXXConcatR}[1]{\ottdrule[#1]{%
\ottpremise{\epsilon  \rightarrow  \epsilon'}%
}{
\nu  \,{+}\!{+}\,  \epsilon  \rightarrow  \nu  \,{+}\!{+}\,  \epsilon'}{%
{\ottdrulename{TStep\_ConcatR}}{}%
}}


\newcommand{\ottdruleTStepXXProjRcd}[1]{\ottdrule[#1]{%
\ottpremise{\ottkw{lookup} \, \ell \, \nu_{{\mathrm{1}}}  \Rightarrow  \nu_{{\mathrm{2}}}}%
}{
\nu_{{\mathrm{1}}}  \ottsym{.}  \ell  \rightarrow  \nu_{{\mathrm{2}}}}{%
{\ottdrulename{TStep\_ProjRcd}}{}%
}}


\newcommand{\ottdruleTStepXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{\epsilon  \rightarrow  \epsilon'}%
}{
\ottsym{\{} \, \ottcomp{\ell_{\ottmv{i}}  \Mapsto  \nu_{\ottmv{i}}}{\ottmv{i}} \, ; \,  \ell  \Mapsto  \epsilon  ; \, \, \ottcomp{\ell_{\ottmv{j}}  \Mapsto  \epsilon_{\ottmv{j}}}{\ottmv{j}} \, \ottsym{\}}  \rightarrow  \ottsym{\{} \, \ottcomp{\ell_{\ottmv{i}}  \Mapsto  \nu_{\ottmv{i}}}{\ottmv{i}} \, ; \,  \ell  \Mapsto  \epsilon'  ; \, \, \ottcomp{\ell_{\ottmv{j}}  \Mapsto  \epsilon_{\ottmv{j}}}{\ottmv{j}} \, \ottsym{\}}}{%
{\ottdrulename{TStep\_Rcd}}{}%
}}


\newcommand{\ottdruleTStepXXConcat}[1]{\ottdrule[#1]{%
}{
\ottsym{\{} \, \ottcomp{\ell_{\ottmv{i}}  \Mapsto  \nu_{\ottmv{i}}}{\ottmv{i}} \, \ottsym{\}}  \,{+}\!{+}\,  \ottsym{\{} \, \ottcomp{\ell_{\ottmv{j}}  \Mapsto  \nu_{\ottmv{j}}}{\ottmv{j}} \, \ottsym{\}}  \rightarrow  \ottsym{\{} \, \ottcomp{\ell_{\ottmv{i}}  \Mapsto  \nu_{\ottmv{i}}}{\ottmv{i}} \, ; \, \, \ottcomp{\ell  \Mapsto  \nu_{\ottmv{j}}}{\ottmv{j}} \, \ottsym{\}}}{%
{\ottdrulename{TStep\_Concat}}{}%
}}


\newcommand{\ottdruleTStepXXAppAbs}[1]{\ottdrule[#1]{%
}{
\ottsym{(}   \lambda \ottmv{x} .\, \epsilon   \ottsym{)} \, \nu  \rightarrow  \epsilon  \ottsym{[}  \ottmv{x}  \mapsto  \nu  \ottsym{]}}{%
{\ottdrulename{TStep\_AppAbs}}{}%
}}

\newcommand{\ottdefntargetXXstep}[1]{\begin{ottdefnblock}[#1]{$\epsilon  \rightarrow  \epsilon'$}{\ottcom{Small-step semantics}}
\ottusedrule{\ottdruleTStepXXProj{}}
\ottusedrule{\ottdruleTStepXXAppL{}}
\ottusedrule{\ottdruleTStepXXAppR{}}
\ottusedrule{\ottdruleTStepXXConcatL{}}
\ottusedrule{\ottdruleTStepXXConcatR{}}
\ottusedrule{\ottdruleTStepXXProjRcd{}}
\ottusedrule{\ottdruleTStepXXRcd{}}
\ottusedrule{\ottdruleTStepXXConcat{}}
\ottusedrule{\ottdruleTStepXXAppAbs{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsTargetStep}{
\ottdefntargetXXstep{}}

% defns ConcatTypes
%% defn concat_typ
\newcommand{\ottdruleCTXXNil}[1]{\ottdrule[#1]{%
}{
 \ottsym{\{}  \,  \ottsym{\}} \uplus \rho \Rightarrow \rho }{%
{\ottdrulename{CT\_Nil}}{}%
}}


\newcommand{\ottdruleCTXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{ \ottkw{lookup} \, \ell \, \rho_{{\mathrm{2}}}  \sim  \mathcal{A} \enspace\and\enspace  \rho_{{\mathrm{1}}} \uplus \rho_{{\mathrm{2}}} \Rightarrow \rho_{{\mathrm{3}}}  }%
}{
 \ottsym{\{}  \ell  \Mapsto  \mathcal{A}  \mid  \rho_{{\mathrm{1}}}  \ottsym{\}} \uplus \rho_{{\mathrm{2}}} \Rightarrow \ottsym{\{}  \ell  \Mapsto  \mathcal{A}  \mid  \rho_{{\mathrm{3}}}  \ottsym{\}} }{%
{\ottdrulename{CT\_Rcd}}{}%
}}

\newcommand{\ottdefnconcatXXtyp}[1]{\begin{ottdefnblock}[#1]{$ \rho_{{\mathrm{1}}} \uplus \rho_{{\mathrm{2}}} \Rightarrow \rho_{{\mathrm{3}}} $}{\ottcom{Record type concatenation}}
\ottusedrule{\ottdruleCTXXNil{}}
\ottusedrule{\ottdruleCTXXRcd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsConcatTypes}{
\ottdefnconcatXXtyp{}}

% defns RecordTypes
%% defn rcd_typ
\newcommand{\ottdruleRTXXNil}[1]{\ottdrule[#1]{%
}{
\ottkw{rcdTyp} \, \ottsym{\{}  \,  \ottsym{\}}}{%
{\ottdrulename{RT\_Nil}}{}%
}}


\newcommand{\ottdruleRTXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{\ottkw{rcdTyp} \, \rho}%
}{
\ottkw{rcdTyp} \, \ottsym{\{}  \ell  \Mapsto  \mathcal{A}  \mid  \rho  \ottsym{\}}}{%
{\ottdrulename{RT\_Rcd}}{}%
}}

\newcommand{\ottdefnrcdXXtyp}[1]{\begin{ottdefnblock}[#1]{$\ottkw{rcdTyp} \, \mathcal{A}$}{\ottcom{Valid record types}}
\ottusedrule{\ottdruleRTXXNil{}}
\ottusedrule{\ottdruleRTXXRcd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsRecordTypes}{
\ottdefnrcdXXtyp{}}

% defns ContainedByRcdTyp
%% defn contained_by_rcd_typ
\newcommand{\ottdruleCRTXXHead}[1]{\ottdrule[#1]{%
}{
\ottsym{\{}  \ell_{{\mathrm{1}}}  \Mapsto  \mathcal{A}  \mid  \rho  \ottsym{\}}  \,\rhd\,  \ell_{{\mathrm{1}}}  :  \mathcal{A}}{%
{\ottdrulename{CRT\_Head}}{}%
}}


\newcommand{\ottdruleCRTXXTail}[1]{\ottdrule[#1]{%
\ottpremise{\rho  \,\rhd\,  \ell_{{\mathrm{2}}}  :  \mathcal{C}}%
}{
\ottsym{\{}  \ell_{{\mathrm{1}}}  \Mapsto  \mathcal{A}  \mid  \rho  \ottsym{\}}  \,\rhd\,  \ell_{{\mathrm{2}}}  :  \mathcal{C}}{%
{\ottdrulename{CRT\_Tail}}{}%
}}

\newcommand{\ottdefncontainedXXbyXXrcdXXtyp}[1]{\begin{ottdefnblock}[#1]{$\rho  \,\rhd\,  \ell  :  \mathcal{B}$}{\ottcom{Non-deterministic lookup}}
\ottusedrule{\ottdruleCRTXXHead{}}
\ottusedrule{\ottdruleCRTXXTail{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsContainedByRcdTyp}{
\ottdefncontainedXXbyXXrcdXXtyp{}}

% defns WellformedTypes
%% defn wf_typ
\newcommand{\ottdruleWFXXNil}[1]{\ottdrule[#1]{%
}{
\vdash  \ottsym{\{}  \,  \ottsym{\}}}{%
{\ottdrulename{WF\_Nil}}{}%
}}


\newcommand{\ottdruleWFXXInt}[1]{\ottdrule[#1]{%
}{
\vdash   \mathbb{Z} }{%
{\ottdrulename{WF\_Int}}{}%
}}


\newcommand{\ottdruleWFXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{ \vdash  \mathcal{A} \enspace\and\enspace \vdash  \mathcal{B} }%
}{
\vdash  \mathcal{A}  \rightarrow  \mathcal{B}}{%
{\ottdrulename{WF\_Arrow}}{}%
}}


\newcommand{\ottdruleWFXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{  \vdash  \mathcal{A} \enspace\and\enspace \vdash  \rho  \enspace\and\enspace \ottkw{lookup} \, \ell \, \rho  \sim  \mathcal{A} }%
}{
\vdash  \ottsym{\{}  \ell  \Mapsto  \mathcal{A}  \mid  \rho  \ottsym{\}}}{%
{\ottdrulename{WF\_Rcd}}{}%
}}

\newcommand{\ottdefnwfXXtyp}[1]{\begin{ottdefnblock}[#1]{$\vdash  \mathcal{A}$}{\ottcom{Type well-formedness}}
\ottusedrule{\ottdruleWFXXNil{}}
\ottusedrule{\ottdruleWFXXInt{}}
\ottusedrule{\ottdruleWFXXArrow{}}
\ottusedrule{\ottdruleWFXXRcd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsWellformedTypes}{
\ottdefnwfXXtyp{}}

% defns WellformedCtx
%% defn wf_ctx
\newcommand{\ottdruleWFCXXNil}[1]{\ottdrule[#1]{%
}{
\vdash   \cdot }{%
{\ottdrulename{WFC\_Nil}}{}%
}}


\newcommand{\ottdruleWFCXXCons}[1]{\ottdrule[#1]{%
\ottpremise{ \vdash  \mathcal{A} \enspace\and\enspace \vdash  \Delta }%
}{
\vdash  \Delta  \ottsym{,}  \ottmv{x}  :  \mathcal{A}}{%
{\ottdrulename{WFC\_Cons}}{}%
}}

\newcommand{\ottdefnwfXXctx}[1]{\begin{ottdefnblock}[#1]{$\vdash  \Delta$}{\ottcom{Context well-formedness}}
\ottusedrule{\ottdruleWFCXXNil{}}
\ottusedrule{\ottdruleWFCXXCons{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsWellformedCtx}{
\ottdefnwfXXctx{}}

% defns TargetTyping
%% defn target_typing
\newcommand{\ottdruleTypXXInt}[1]{\ottdrule[#1]{%
\ottpremise{\vdash  \Delta}%
}{
\Delta  \vdash  \ottmv{n}  :   \mathbb{Z} }{%
{\ottdrulename{Typ\_Int}}{}%
}}


\newcommand{\ottdruleTypXXAbs}[1]{\ottdrule[#1]{%
\ottpremise{\Delta  \ottsym{,}  \ottmv{x}  :  \mathcal{A}  \vdash  \epsilon  :  \mathcal{B}}%
}{
\Delta  \vdash   \lambda \ottmv{x} .\, \epsilon   :  \mathcal{A}  \rightarrow  \mathcal{B}}{%
{\ottdrulename{Typ\_Abs}}{}%
}}


\newcommand{\ottdruleTypXXApp}[1]{\ottdrule[#1]{%
\ottpremise{  \Delta  \vdash  \epsilon_{{\mathrm{1}}}  :  \mathcal{A}  \rightarrow  \mathcal{B} \enspace\and\enspace \Delta  \vdash  \epsilon_{{\mathrm{2}}}  :  \mathcal{A}'  \enspace\and\enspace \mathcal{A}  \approx  \mathcal{A}' }%
}{
\Delta  \vdash  \epsilon_{{\mathrm{1}}} \, \epsilon_{{\mathrm{2}}}  :  \mathcal{B}}{%
{\ottdrulename{Typ\_App}}{}%
}}


\newcommand{\ottdruleTypXXRcdNil}[1]{\ottdrule[#1]{%
\ottpremise{\vdash  \Delta}%
}{
\Delta  \vdash  \ottsym{\{}  \,  \ottsym{\}}  :  \ottsym{\{}  \,  \ottsym{\}}}{%
{\ottdrulename{Typ\_RcdNil}}{}%
}}


\newcommand{\ottdruleTypXXRcdCons}[1]{\ottdrule[#1]{%
\ottpremise{  \Delta  \vdash  \epsilon  :  \mathcal{A} \enspace\and\enspace \Delta  \vdash  \ottsym{\{}  \ell_{{\mathrm{1}}}  \Mapsto  \epsilon_{{\mathrm{1}}}  ; \, \, ... \, ; \,  \ell_{\ottmv{n}}  \Mapsto  \epsilon_{\ottmv{n}}  \ottsym{\}}  :  \rho  \enspace\and\enspace \ottkw{lookup} \, \ell \, \rho  \sim  \mathcal{A} }%
}{
\Delta  \vdash  \ottsym{\{}  \ell  \Mapsto  \epsilon  ; \,  \ell_{{\mathrm{1}}}  \Mapsto  \epsilon_{{\mathrm{1}}}  ; \, \, ... \, ; \,  \ell_{\ottmv{n}}  \Mapsto  \epsilon_{\ottmv{n}}  \ottsym{\}}  :  \ottsym{\{}  \ell  \Mapsto  \mathcal{A}  \mid  \rho  \ottsym{\}}}{%
{\ottdrulename{Typ\_RcdCons}}{}%
}}


\newcommand{\ottdruleTypXXVar}[1]{\ottdrule[#1]{%
\ottpremise{ \vdash  \Delta  \ottlinebreakhack }%
\ottpremise{\ottmv{x}  :  \mathcal{A} \, \in \, \Delta}%
}{
\Delta  \vdash  \ottmv{x}  :  \mathcal{A}}{%
{\ottdrulename{Typ\_Var}}{}%
}}


\newcommand{\ottdruleTypXXRcdProj}[1]{\ottdrule[#1]{%
\ottpremise{ \Delta  \vdash  \epsilon  :  \rho \enspace\and\enspace \ottkw{lookup} \, \ell \, \rho  \Rightarrow  \mathcal{B} }%
}{
\Delta  \vdash  \epsilon  \ottsym{.}  \ell  :  \mathcal{B}}{%
{\ottdrulename{Typ\_RcdProj}}{}%
}}


\newcommand{\ottdruleTypXXRcdMerge}[1]{\ottdrule[#1]{%
\ottpremise{ \rho_{{\mathrm{1}}} \uplus \rho_{{\mathrm{2}}} \Rightarrow \rho_{{\mathrm{3}}} }%
\ottpremise{ \Delta  \vdash  \epsilon_{{\mathrm{1}}}  :  \rho_{{\mathrm{1}}} \enspace\and\enspace \Delta  \vdash  \epsilon_{{\mathrm{2}}}  :  \rho_{{\mathrm{2}}} }%
}{
\Delta  \vdash  \epsilon_{{\mathrm{1}}}  \,{+}\!{+}\,  \epsilon_{{\mathrm{2}}}  :  \rho_{{\mathrm{3}}}}{%
{\ottdrulename{Typ\_RcdMerge}}{}%
}}

\newcommand{\ottdefntargetXXtyping}[1]{\begin{ottdefnblock}[#1]{$\Delta  \vdash  \epsilon  :  \mathcal{A}$}{\ottcom{Typing}}
\ottusedrule{\ottdruleTypXXInt{}}
\ottusedrule{\ottdruleTypXXAbs{}}
\ottusedrule{\ottdruleTypXXApp{}}
\ottusedrule{\ottdruleTypXXRcdNil{}}
\ottusedrule{\ottdruleTypXXRcdCons{}}
\ottusedrule{\ottdruleTypXXVar{}}
\ottusedrule{\ottdruleTypXXRcdProj{}}
\ottusedrule{\ottdruleTypXXRcdMerge{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsTargetTyping}{
\ottdefntargetXXtyping{}}

% defns RTSubtyping
%% defn rtsub
\newcommand{\ottdruleRTSXXRefl}[1]{\ottdrule[#1]{%
}{
 \mathcal{A}  \subseteq  \mathcal{A} }{%
{\ottdrulename{RTS\_Refl}}{}%
}}


\newcommand{\ottdruleRTSXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{\mathcal{A}  \approx  \mathcal{A}'}%
\ottpremise{\mathcal{B}  \approx  \mathcal{B}'}%
}{
 \mathcal{A}  \rightarrow  \mathcal{B}  \subseteq  \mathcal{A}'  \rightarrow  \mathcal{B}' }{%
{\ottdrulename{RTS\_Arrow}}{}%
}}


\newcommand{\ottdruleRTSXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{ \forall  \ell ~ \mathcal{C} ,\,  \text{if~}  \ottkw{lookup} \, \ell \, \rho_{{\mathrm{2}}}  \Rightarrow  \mathcal{C}  \text{~then~}  \ottkw{lookup} \, \ell \, \rho_{{\mathrm{1}}}  \approx  \mathcal{C}  }%
}{
 \rho_{{\mathrm{1}}}  \subseteq  \rho_{{\mathrm{2}}} }{%
{\ottdrulename{RTS\_Rcd}}{}%
}}

\newcommand{\ottdefnrtsub}[1]{\begin{ottdefnblock}[#1]{$ \mathcal{A}  \subseteq  \mathcal{B} $}{\ottcom{Width subtyping}}
\ottusedrule{\ottdruleRTSXXRefl{}}
\ottusedrule{\ottdruleRTSXXArrow{}}
\ottusedrule{\ottdruleRTSXXRcd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsRTSubtyping}{
\ottdefnrtsub{}}

\newcommand{\ottdefnss}{
\ottdefnsTopLikeType
\ottdefnsSplitType
\ottdefnsOrdinaryType
\ottdefnsDisjoint
\ottdefnsRSubtyping
\ottdefnsCoMerge
\ottdefnsCoSubtyping
\ottdefnsProjection
\ottdefnsDistributiveApplication
\ottdefnsElaboration
\ottdefnsDunElaboration
\ottdefnsValues
\ottdefnsTargetStep
\ottdefnsConcatTypes
\ottdefnsRecordTypes
\ottdefnsContainedByRcdTyp
\ottdefnsWellformedTypes
\ottdefnsWellformedCtx
\ottdefnsTargetTyping
\ottdefnsRTSubtyping
}

\newcommand{\ottall}{\ottmetavars\\[0pt]
\ottgrammar\\[5.0mm]
\ottdefnss}

